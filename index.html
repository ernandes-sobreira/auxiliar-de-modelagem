<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Curso – Estatística e Modelagem (Biologia/Ecologia/Saúde)</title>
  <style>
    :root{
      --text:#0b1220; --muted:#475569; --line:#e5e7eb; --shadow:0 10px 24px rgba(2,6,23,.08);
      --pink:#ff006e; --blue:#3a86ff; --green:#06d6a0; --yellow:#ffbe0b; --orange:#fb5607; --purple:#8338ec;
    }
    *{box-sizing:border-box}
    body{margin:0;background:#fff;color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.6}
    header{
      border-bottom:1px solid var(--line);
      background:
        radial-gradient(1000px 380px at 10% -10%, rgba(255,0,110,.14), transparent 55%),
        radial-gradient(1000px 380px at 90% -10%, rgba(58,134,255,.14), transparent 55%),
        radial-gradient(1000px 380px at 50% 10%, rgba(6,214,160,.08), transparent 60%),
        #fff;
    }
    .wrap{max-width:1180px;margin:0 auto;padding:0 14px}
    h1{margin:0;padding:18px 0 6px;font-size:22px;letter-spacing:-.01em}
    .sub{margin:0 0 14px;color:var(--muted);font-size:13px;max-width:1080px}
    .badges{display:flex;flex-wrap:wrap;gap:8px;padding:0 0 16px}
    .badge{font-size:12px;padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#fff;box-shadow:0 4px 12px rgba(2,6,23,.04)}
    main{padding:14px 0 28px}
    .grid{display:grid;grid-template-columns:430px 1fr;gap:12px}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}
    .card{border:1px solid var(--line);border-radius:16px;background:#fff;box-shadow:var(--shadow);overflow:hidden}
    .cardHead{padding:12px;border-bottom:1px solid var(--line);display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .cardHead strong{font-size:14px}
    .btnRow{display:flex;gap:10px;flex-wrap:wrap}
    button{border:none;border-radius:12px;padding:10px 12px;cursor:pointer;font-weight:900;background:#f1f5f9;border:1px solid var(--line);color:var(--text)}
    button.primary{background:linear-gradient(90deg,var(--blue),var(--pink));color:#fff;border:none}
    button.accent{background:linear-gradient(90deg,var(--green),var(--yellow));border:none}
    button.warn{background:linear-gradient(90deg,var(--orange),var(--pink));color:#fff;border:none}
    button:disabled{opacity:.55;cursor:not-allowed}
    .list{padding:10px 12px;max-height:72vh;overflow:auto}
    .lessonBtn{width:100%;text-align:left;background:#fff;border:1px solid var(--line);border-radius:14px;padding:10px;cursor:pointer;margin:10px 0;transition:.12s transform ease}
    .lessonBtn:hover{transform:translateY(-1px)}
    .topLine{display:flex;justify-content:space-between;gap:10px;font-weight:900;font-size:13px}
    .dates{margin-top:4px;color:var(--muted);font-size:12px}
    .tag{font-size:11px;padding:4px 8px;border-radius:999px;color:#fff;background:linear-gradient(90deg,var(--orange),var(--pink));white-space:nowrap}
    .tag.ok{background:linear-gradient(90deg,var(--green),var(--yellow));color:#0b1220}
    .content{padding:12px 12px 14px}
    .title{font-size:18px;margin:0 0 6px}
    .meta{color:var(--muted);font-size:12px;margin-bottom:12px}
    details{border:1px solid var(--line);border-radius:14px;overflow:hidden;background:#fff;margin:10px 0}
    summary{list-style:none;cursor:pointer;padding:12px;font-weight:900;display:flex;justify-content:space-between;gap:10px;align-items:center}
    summary::-webkit-details-marker{display:none}
    .chip{font-size:11px;padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:#fff;white-space:nowrap}
    .sec{padding:0 12px 12px}
    .sec p{margin:10px 0}
    .sec ul,.sec ol{margin:8px 0 10px 18px}
    .box{border-radius:14px;border:1px dashed rgba(58,134,255,.35);background:rgba(58,134,255,.06);padding:10px;margin:10px 0}
    .box.ok{border:1px dashed rgba(6,214,160,.45);background:rgba(6,214,160,.08)}
    .box.warn{border:1px dashed rgba(251,86,7,.45);background:rgba(251,86,7,.08)}
    .box.purple{border:1px dashed rgba(131,56,236,.45);background:rgba(131,56,236,.08)}
    .links a{color:#0b1220;font-weight:900;text-decoration:none;border-bottom:2px solid rgba(58,134,255,.35);word-break:break-word}
    .linkItem{border:1px solid var(--line);border-radius:14px;padding:10px;margin:10px 0;background:#fff}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:720px){.row{grid-template-columns:1fr}}
    input[type="text"],input[type="url"]{width:100%;border:1px solid var(--line);border-radius:12px;padding:10px;outline:none;font-size:13px;font-family:inherit}
    .quiz{border:1px solid var(--line);border-radius:14px;padding:12px;background:#fff;margin-top:10px}
    .q{border-top:1px solid var(--line);padding-top:10px;margin-top:10px}
    .q:first-child{border-top:none;padding-top:0;margin-top:0}
    .qtitle{font-weight:900;margin-bottom:6px}
    .opts label{display:block;margin:6px 0}
    .result{margin-top:10px;background:#0b1220;color:#e2e8f0;border-radius:14px;padding:10px;font-size:12px;white-space:pre-wrap;display:none}
    .callout{border-left:6px solid rgba(58,134,255,.45);padding:10px 12px;background:rgba(58,134,255,.06);border-radius:14px}
    code.inline{background:#f1f5f9;border:1px solid var(--line);padding:2px 6px;border-radius:8px;font-size:12px}
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <h1>Curso – Estatística e Modelagem (Biologia/Ecologia/Saúde)</h1>
    <p class="sub">
      Cada semana tem roteiro próprio: explicações do zero, exemplos do cotidiano, passo a passo e interpretação.
      Links são somente Khan/YouTube (editáveis). Salve suas notas no navegador ou no celular.
    </p>
    <div class="badges">
      <span class="badge">60h • 15 semanas • 4h/semana</span>
      <span class="badge">Online</span>
      <span class="badge">PAST 4 + LibreOffice</span>
      <span class="badge">Dossiê semanal (1 lauda)</span>
      <span class="badge">Quiz curto por semana</span>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="grid">

    <section class="card">
      <div class="cardHead">
        <strong>Semanas</strong>
        <div class="btnRow">
          <button class="accent" id="btnExport">Exportar progresso (JSON)</button>
          <button class="warn" id="btnReset">Resetar</button>
        </div>
      </div>
      <div class="list" id="lessonList"></div>
    </section>

    <section class="card">
      <div class="cardHead">
        <strong>Semana selecionada</strong>
        <div class="btnRow">
          <button class="primary" id="btnDone">Marcar como concluída</button>
          <button id="btnUndone">Desmarcar</button>
        </div>
      </div>
      <div class="content">
        <h2 class="title" id="title">Selecione uma semana</h2>
        <div class="meta" id="meta">—</div>
        <div id="panels"></div>
      </div>
    </section>

  </div>
</main>

<script>
  // =======================
  // 1) SEMANAS (títulos + datas)
  // =======================
  const LESSONS = [
    {id:1,  dates:"23/02/2026 a 28/02/2026", title:"Pergunta científica + desenho amostral"},
    {id:2,  dates:"02/03/2026 a 07/03/2026", title:"Tipos de dados/variáveis + organização da tabela"},
    {id:3,  dates:"09/03/2026 a 14/03/2026", title:"Gráficos (semana exclusiva) + como escolher e interpretar"},
    {id:4,  dates:"16/03/2026 a 21/03/2026", title:"Probabilidade e inferência na prática"},
    {id:5,  dates:"23/03/2026 a 28/03/2026", title:"Distribuições (normal, binomial, Poisson) com exemplos simples"},
    {id:6,  dates:"30/03/2026 a 04/04/2026", title:"Premissas + outliers + decisão paramétrico vs não paramétrico"},
    {id:7,  dates:"06/04/2026 a 11/04/2026", title:"Teste t (2 grupos) + tamanho de efeito e interpretação"},
    {id:8,  dates:"13/04/2026 a 18/04/2026", title:"ANOVA 1 via (3+ grupos) + pós-testes (Tukey/LSD)"},
    {id:9,  dates:"20/04/2026 a 25/04/2026", title:"ANOVA 2 vias + interação"},
    {id:10, dates:"27/04/2026 a 02/05/2026", title:"Qui-quadrado (categorias) + tabelas de contingência"},
    {id:11, dates:"04/05/2026 a 09/05/2026", title:"Correlação (Pearson/Spearman) + por que não é causalidade"},
    {id:12, dates:"11/05/2026 a 16/05/2026", title:"Regressão linear + resíduos + previsões"},
    {id:13, dates:"18/05/2026 a 23/05/2026", title:"GLM (Poisson/Binomial) – contagens e proporções"},
    {id:14, dates:"25/05/2026 a 30/05/2026", title:"Multivariado + ANCOVA + viés + teste cego"},
    {id:15, dates:"01/06/2026 a 06/06/2026", title:"Projeto final: pergunta, dados, análise e apresentação"}
  ];

  // =======================
  // 2) LINKS – padrão só Khan (PT). Você edita por semana.
  // =======================
  const DEFAULT_LINKS = [
    {label:"Khan Academy (PT) – Estatística e probabilidade", url:"https://pt.khanacademy.org/math/statistics-probability"}
  ];

  // =======================
  // 3) ESTADO
  // =======================
  const KEY = "curso_plataforma_v6_s1_s2";
  let state = { currentId:null, done:{}, links:{} };
  function loadState(){
    const raw = localStorage.getItem(KEY);
    if(raw){ try{ state = JSON.parse(raw); } catch(e){} }
  }
  function saveState(){ localStorage.setItem(KEY, JSON.stringify(state)); }
  function getLinksFor(id){
    const custom = state.links?.[id];
    if(Array.isArray(custom)) return custom;
    return DEFAULT_LINKS.slice();
  }

  // =======================
  // 4) CONTEÚDO POR SEMANA
  // =======================
  const COURSE = {
    1: week1Master(),
    2: week2Master(),
    3: mkWeek3Short(),
    4: mkWeek4Short(),
    5: mkWeek5Short(),
    6: mkWeek6Short(),
    7: mkWeek7Short(),
    8: mkWeek8Short(),
    9: mkWeek9Short(),
    10: mkWeek10Short(),
    11: mkWeek11Short(),
    12: mkWeek12Short(),
    13: mkWeek13Short(),
    14: mkWeek14Short(),
    15: mkWeek15Short()
  };

  // -------- Semana 1 (MASTER) --------
  function week1Master(){
    return {
      goals:[
        "Transformar curiosidade em pergunta científica testável (sem ficar vago).",
        "Entender do zero o que são X (explicativa) e Y (resposta) e por que isso manda na análise.",
        "Definir unidade amostral e réplicas para não cair em pseudorrepetição.",
        "Planejar um desenho amostral simples, possível em 7 dias, com dados do cotidiano e custo zero.",
        "Montar uma tabela mínima correta e produzir um primeiro gráfico coerente com a pergunta."
      ],
      definitions:[
        {term:"Ciência (o que significa aqui)", def:"Ciência é um jeito organizado de fazer perguntas sobre o mundo e usar dados para reduzir achismo. Não é decorar fórmula. É perguntar bem, medir bem e interpretar com honestidade."},
        {term:"Curiosidade vs pergunta científica", def:"Curiosidade é ampla (“o clima afeta minha vida?”). Pergunta científica é específica e testável (“em dias mais quentes, eu bebo mais água?”). Se vira uma tabela com números, está no caminho certo."},
        {term:"Variável", def:"Qualquer coisa que pode mudar e que você consegue registrar. Pode ser número (horas de sono) ou categoria (choveu: sim/não)."},
        {term:"Y (variável resposta)", def:"Y é o resultado que você quer entender. Ex.: horas de sono; passos; humor (0–10); copos de água."},
        {term:"X (variável explicativa)", def:"X é o fator que você suspeita que se relaciona com Y. Ex.: tempo de tela; temperatura; horas de estudo; treino (sim/não)."},
        {term:"Eixos", def:"Os eixos são as ‘réguas’ do gráfico. O eixo horizontal costuma mostrar X; o vertical costuma mostrar Y. Trocar eixo muda a leitura e, às vezes, muda a pergunta."},
        {term:"Unidade", def:"Minutos, horas, passos, °C, copos… Unidade clara evita confusão e facilita correção."},
        {term:"Observação", def:"Uma observação é uma linha da tabela. Ex.: um dia com valores de Y e X."},
        {term:"Unidade amostral", def:"O que conta como 1 observação independente (ex.: 1 dia). Isso define o que é réplica de verdade."},
        {term:"Réplica", def:"Unidades independentes repetidas (ex.: 7 dias). Não é repetir o mesmo dia 3 vezes."},
        {term:"Variação", def:"A vida muda. Sono, passos e humor não são constantes. Estatística existe para lidar com essa variação sem se enganar."},
        {term:"Dispersão", def:"O quão espalhados os valores estão. Dois conjuntos podem ter a mesma média e dispersões bem diferentes."},
        {term:"Média", def:"Um resumo útil, mas pode esconder extremos. Por isso gráfico importa."},
        {term:"Variância", def:"Uma forma de medir dispersão: quanto os dados se afastam da média. Variância grande = dados muito diferentes entre si."},
        {term:"Sinal vs ruído", def:"Sinal é padrão consistente; ruído é variação do cotidiano. A meta é não confundir ruído com sinal."},
        {term:"Viés", def:"Erro sistemático: escolher só dias bons, medir em horários diferentes, registrar quando lembra. Viés engana sem parecer erro."},
        {term:"Pseudorrepetição", def:"Tratar medidas não independentes como réplicas (ex.: repetir o mesmo dia e dizer que aumentou o n)."}
      ],
      mindset:[
        "A estatística não é tribunal. Ela te ensina a fazer perguntas melhores e interpretar padrões com cautela.",
        "Antes de teste, o cientista olha o gráfico e pergunta: ‘isso parece sinal ou é só vida variando?’",
        "Padronização + réplicas + transparência = credibilidade."
      ],
      story:[
        "Imagine duas semanas: em uma você usa muito o celular à noite; em outra, você reduz. Você quer saber se isso muda seu sono.",
        "Se você só olhar um dia, você se engana fácil. Um dia ruim acontece.",
        "Quando você registra vários dias com a mesma regra, você começa a ver se há padrão real."
      ],
      howTo:{
        title:"Como montar um mini-projeto científico em 7 dias (sem instrumentos)",
        steps:[
          "Escolha uma pergunta que vire tabela com números.",
          "Defina Y e X em 1 linha: ‘Quero investigar se X está associado a Y’.",
          "Defina unidade amostral (recomendação: 1 dia).",
          "Defina regra fixa de coleta (padronização): horário e forma de registrar.",
          "Garanta réplicas: mínimo 6 dias; ideal 7 dias completos.",
          "Monte tabela mínima: Data | Y | X | Observações (curto).",
          "Faça 1 gráfico coerente: se X e Y são numéricos, use dispersão; se X é categoria (sim/não), use boxplot com pontos."
        ],
        dataIdeas:[
          "Sono (h) vs tempo de tela (min) (celular).",
          "Passos do dia vs tempo sentado (celular).",
          "Temperatura (app clima) vs consumo de água (copos).",
          "Choveu (sim/não) vs humor (0–10).",
          "Treino (sim/não) vs qualidade do sono (0–10)."
        ]
      },
      interpret:[
        "Nesta primeira semana, a qualidade do desenho vale mais do que o resultado. O foco é: pergunta + padronização + réplicas.",
        "Uma interpretação boa tem 3 frases: pergunta; desenho (unidade amostral e réplicas); o que você espera ver no gráfico.",
        "Evite ‘prova/certo/garantido’. Use ‘investigar/sugerir/observar padrão’."
      ],
      mistakes:[
        "Pergunta ampla demais (não vira tabela).",
        "Mudar regra de coleta no meio da semana.",
        "Confundir réplica com repetir a mesma medida no mesmo dia.",
        "Registrar média da semana em vez de registrar cada dia.",
        "Esquecer unidades."
      ],
      activity:"Defina uma pergunta científica executável, planeje o desenho e colete no mínimo 6 observações (dias). Produza tabela mínima e 1 gráfico coerente.",
      dossier:[
        "Pergunta científica (1 linha).",
        "Definições do seu projeto (4 linhas): Y, X, unidade amostral, regra fixa de coleta.",
        "Tabela mínima (mín. 6 linhas).",
        "1 gráfico preliminar coerente com a pergunta.",
        "Parágrafo curto (5–7 linhas): o que você espera ver e qual é a principal limitação."
      ],
      dossierModelText:
        "Pergunta científica: ‘O tempo de tela à noite (X, em minutos) está associado ao número de horas de sono (Y, em horas) ao longo de dias?’. " +
        "Unidade amostral: 1 dia. Réplicas: 7 dias. Regra fixa: registrar sempre às 9h os valores do dia anterior. " +
        "Gráfico (dispersão) para observar se, quando X aumenta, Y tende a diminuir. Limitação: stress/café/barulho podem afetar o sono e não serão medidos nesta semana.",
      saturday:"Sábado 28/02/2026: nesta data não haverá encontro de tira-dúvidas. O sábado será usado para organizar a tabela, revisar a pergunta e enviar o dossiê semanal (1 lauda).",
      quiz:[
        {q:"Em uma pergunta científica bem formada, Y representa:", opts:[
          "O eixo do gráfico (sempre)",
          "A variável resposta (o resultado que quero entender)",
          "A unidade amostral",
          "O viés do estudo"
        ], ans:1, fb:[
          "Eixo e variável podem se relacionar, mas não são a mesma coisa.",
          "Correto. Y é o resultado que você quer explicar/entender.",
          "Unidade amostral é outra ideia: o que conta como uma observação.",
          "Viés é um tipo de erro sistemático, não é Y."
        ]},
        {q:"Qual situação descreve réplica (e não repetição técnica)?", opts:[
          "Medir o mesmo dia 3 vezes",
          "Registrar 7 dias diferentes com a mesma regra",
          "Editar a tabela para ficar bonita",
          "Excluir dias que deram diferente"
        ], ans:1, fb:[
          "Isso é repetição técnica, não garante independência.",
          "Correto. Réplica são unidades independentes (dias diferentes).",
          "Isso é formatação, não desenho amostral.",
          "Isso cria viés e estraga o estudo."
        ]},
        {q:"Um bom motivo para definir unidade amostral é:", opts:[
          "Para aumentar o p-valor",
          "Para saber quantas observações independentes existem",
          "Para provar causalidade",
          "Para eliminar variância"
        ], ans:1, fb:[
          "p-valor não é objetivo do desenho.",
          "Correto. Sem unidade amostral, você se engana sobre n e independência.",
          "Causalidade depende de desenho experimental; unidade amostral é parte da base.",
          "Variância existe; a ideia é lidar bem com ela."
        ]}
      ]
    };
  }

  // -------- Semana 2 (MASTER) --------
  function week2Master(){
    return {
      goals:[
        "Entender, do zero, os tipos de dados mais comuns (número, categoria, contagem, proporção) e por que isso decide o gráfico e o teste.",
        "Aprender a montar uma tabela ‘analisável’: 1 linha = 1 observação; 1 coluna = 1 variável; unidades no lugar certo.",
        "Evitar os erros que mais derrubam análises: misturar texto com número, unidades confusas, datas mal registradas, valores impossíveis.",
        "Aprender a fazer uma ‘checagem de sanidade’ dos dados (antes de qualquer gráfico): o que parece erro de digitação? o que parece evento real?",
        "Exportar o arquivo em CSV e preparar o dado para PAST 4 / LibreOffice sem sofrimento."
      ],

      mindset:[
        "A maior parte dos erros em estatística não é ‘falta de fórmula’. É tabela ruim. Tabela ruim gera gráfico ruim. Gráfico ruim gera conclusão ruim.",
        "Organizar dados é parte do método científico. É onde você prova que levou a coleta a sério.",
        "A melhor tabela é aquela que outro colega consegue entender em 30 segundos — sem te perguntar nada."
      ],

      story:[
        "Imagine dois alunos com a mesma pergunta: ‘tela vs sono’. Um registra ‘2h’, ‘120min’, ‘duas horas’, e às vezes esquece a data. O outro registra só números e unidade no cabeçalho.",
        "O segundo aluno consegue analisar em 5 minutos. O primeiro vai passar a semana ‘brigando’ com a planilha.",
        "Semana 2 é para você virar o segundo aluno. Isso muda tudo no resto do curso."
      ],

      definitions:[
        {term:"Dado (o que é)", def:"Dado é um registro de observação. É o ‘fato’ que você guardou. Ex.: ‘06/03/2026 – sono 6,5h – tela 180min’. Dado não é opinião; é registro."},

        {term:"Variável (relembrando)", def:"Uma coluna com algo que pode mudar: sono, tela, temperatura, treino (sim/não). Variável é a unidade básica da tabela."},

        {term:"Variável numérica (quantitativa)", def:"Assume valores em forma de número. Pode ser contínua (tempo, temperatura) ou discreta (contagem). Normalmente entra em gráficos como histograma, boxplot, dispersão."},

        {term:"Contínua", def:"Pode assumir muitos valores ‘no meio’. Ex.: 6,2 horas; 6,25 horas; 6,27 horas. Tempo e temperatura costumam ser contínuos."},

        {term:"Discreta (contagem)", def:"Só faz sentido em números inteiros (0, 1, 2…). Ex.: número de despertares; número de copos d’água; número de vezes que você checou o celular."},

        {term:"Variável categórica (qualitativa)", def:"Assume categorias. Ex.: choveu (sim/não); treino (sim/não); turno (manhã/tarde/noite). Categórica manda você pensar em comparação entre grupos ou tabelas de contagem."},

        {term:"Nominal vs ordinal (categóricas)", def:"Nominal: sem ordem (cor, bairro, tipo). Ordinal: com ordem (baixo/médio/alto; ruim/ok/bom). Ordinal pode ser tratada com cuidado (às vezes vira número 1–5, mas isso tem armadilhas)."},

        {term:"Proporção/percentual", def:"Parte de um todo. Ex.: % do dia em tela; % do tempo estudando. Tem limites (0 a 100%) e isso afeta modelos e interpretação."},

        {term:"Unidade (onde colocar)", def:"Unidade deve ficar no cabeçalho (ex.: ‘Sono (h)’, ‘Tela (min)’). Na célula, guarde só o número: 6,5; 180. Isso evita erros e deixa o CSV limpo."},

        {term:"Formato ‘dados arrumados’ (tidy data)", def:"Regra de ouro: cada linha é uma observação; cada coluna é uma variável; cada célula é um valor. Ex.: cada dia é uma linha. Isso permite filtrar, plotar e testar sem gambiarras."},

        {term:"Cabeçalho (por que importa)", def:"O cabeçalho diz o que cada coluna significa e a unidade. Sem cabeçalho claro, ninguém sabe o que é 180 (min? horas? passos?)."},

        {term:"Data (como registrar)", def:"Data é uma variável importante porque define sequência e réplica. Recomenda-se registrar como dia/mês/ano (06/03/2026) de forma consistente. Data inconsistente quebra série temporal."},

        {term:"Valores ausentes", def:"Às vezes você não tem o dado. Isso é normal. O erro é inventar. Registre como vazio ou ‘NA’ (se você usar). Melhor um dado ausente honesto do que um número inventado."},

        {term:"Erro de digitação vs evento real", def:"Erro de digitação é ‘sono 65 horas’. Evento real é ‘sono 3 horas’ (pode acontecer). Semana 2 te treina a separar um do outro com checagem simples."},

        {term:"Checagem de sanidade", def:"Perguntas rápidas: (1) existem valores impossíveis? (2) unidade está consistente? (3) tem duplicata de data? (4) tem números como texto? (5) tem vírgula/ponto confuso?"},

        {term:"Separador decimal (vírgula/ponto)", def:"No Brasil, vírgula é comum (6,5). Em CSV e alguns softwares, ponto (6.5) pode ser mais aceito. O segredo é: seja consistente e, se necessário, converta uma vez no final."},

        {term:"Dicionário de dados (mini)", def:"Uma lista curtinha dizendo o que cada variável significa, unidade e como foi medida. Isso acelera correção e melhora sua escrita científica."}
      ],

      howTo:{
        title:"Como deixar sua tabela pronta para análise (sem dor)",
        steps:[
          "Crie a tabela base com colunas mínimas: Data | Y (unidade) | X (unidade) | Grupo (se existir) | Observações (curto).",
          "Padronize unidades: escolha uma e mantenha (minutos OU horas; não misture).",
          "Padronize escrita numérica: mantenha vírgula OU ponto e não misture na mesma coluna.",
          "Registre apenas números nas células de medidas (nada de ‘120 min’ dentro da célula).",
          "Faça checagem de sanidade: valores impossíveis (ex.: sono 40h), datas repetidas, células vazias e números digitados como texto.",
          "Se você mediu por dia: garanta que cada dia aparece no máximo uma vez.",
          "Salve como CSV: LibreOffice → Arquivo → Salvar como → .csv (se perguntar, mantenha separador padrão e verifique a prévia).",
          "Se for usar PAST 4: ele gosta de colunas numéricas limpas. Tabela limpa = análise rápida."
        ],
        dataIdeas:[
          "Refine o que você já começou na Semana 1: organize a mesma coleta agora corretamente.",
          "Se faltou dado na Semana 1, complete com mais 1–2 dias (sem inventar).",
          "Se você quer trocar a pergunta, troque agora — mas defina Y e X com clareza e refaça a tabela com réplicas."
        ]
      },

      interpret:[
        "Nesta semana, o foco é ‘qualidade de dado’. Você não precisa de teste nenhum ainda para ter um dossiê excelente.",
        "A interpretação boa descreve o seu dado: qual variável é numérica, qual é categórica, qual é contagem, e por que isso importa.",
        "Se seu dado está limpo, você já está 70% do caminho para fazer gráfico bom e teste certo."
      ],

      mistakes:[
        "Misturar unidade dentro da célula (ex.: ‘120 min’ em vez de 120).",
        "Misturar minutos e horas na mesma coluna.",
        "Registrar ‘duas horas’ como texto em vez de número.",
        "Registrar mais de um registro para o mesmo dia (duplicata sem explicação).",
        "Criar tabela ‘largona’ com dias em colunas (fica ruim para análise).",
        "Corrigir dado “na cabeça” (inventar) em vez de marcar como ausente."
      ],

      activity:
        "Pegue seus dados da Semana 1 e transforme em uma tabela perfeita: limpa, consistente e exportável. No final, gere 2 visualizações simples: (1) histograma do Y (para ver forma) e (2) o gráfico que responde a pergunta (dispersão X–Y ou boxplot por grupo).",

      dossier:[
        "Pergunta científica (1 linha).",
        "Mini dicionário de dados (4–6 linhas): nome da variável, o que significa, unidade, como foi medida.",
        "Tabela limpa (mín. 6 linhas) – pode ser print ou CSV anexado.",
        "Checagem de sanidade: liste 3 coisas que você conferiu (unidade, valores impossíveis, duplicatas etc.).",
        "2 gráficos: (1) histograma de Y e (2) gráfico principal da pergunta.",
        "Parágrafo curto (5–7 linhas): o que o histograma sugere sobre o dado e como isso pode influenciar a análise."
      ],

      dossierModelText:
        "Mini dicionário: Data (dd/mm/aaaa); Sono (h) = horas de sono do dia anterior, anotado às 9h; Tela (min) = minutos de tela do dia anterior, anotado às 9h. " +
        "Checagem: (1) não há valores impossíveis (sono <0 ou >24); (2) não há dias duplicados; (3) unidades estão consistentes (sono em horas, tela em minutos). " +
        "O histograma de Sono sugere leve assimetria (alguns dias muito baixos), o que indica que gráficos e testes devem considerar variabilidade e possíveis outliers.",

      saturday:
        "Sábado 07/03/2026: encontro online tira-dúvidas (foco: limpar tabela, conferir unidades, corrigir erros de digitação e exportar CSV).",

      quiz:[
        {q:"Qual regra descreve ‘dados arrumados’ (tidy data)?", opts:[
          "Cada coluna é um dia e cada linha é uma variável",
          "Cada linha é uma observação; cada coluna é uma variável; cada célula é um valor",
          "Tudo em uma célula para ficar simples",
          "Unidade misturada na célula para facilitar leitura"
        ], ans:1, fb:[
          "Isso é formato ‘largo’ e costuma atrapalhar análise.",
          "Correto. Esse formato é o que mais funciona para gráfico e estatística.",
          "Isso destrói a análise.",
          "Isso suja o CSV e atrapalha softwares."
        ]},
        {q:"Onde a unidade deve ficar, de preferência?", opts:[
          "Dentro da célula (ex.: 120 min)",
          "No cabeçalho (ex.: Tela (min))",
          "Nunca colocar unidade",
          "Somente no dossiê, não na tabela"
        ], ans:1, fb:[
          "Isso mistura texto com número.",
          "Correto. Cabeçalho com unidade, célula com número limpo.",
          "Unidade é essencial para interpretação.",
          "Melhor também estar no cabeçalho para análise."
        ]},
        {q:"Um exemplo de variável discreta (contagem) é:", opts:[
          "Temperatura do dia (°C)",
          "Horas de sono",
          "Número de despertares durante a noite",
          "Altura (cm)"
        ], ans:2, fb:[
          "Temperatura é contínua.",
          "Horas podem ser contínuas.",
          "Correto. Contagem costuma ser inteira: 0,1,2…",
          "Altura é contínua."
        ]}
      ]
    };
  }

  // =======================
  // Semanas 3–15 (curtas por enquanto)
  // =======================
  function mkWeek3Short(){ return {
    goals:["Escolher gráficos corretos."],
    definitions:[{term:"Dispersão", def:"Relação X–Y."},{term:"Boxplot", def:"Comparar grupos."}],
    howTo:{title:"Base", steps:["X–Y: dispersão; grupos: boxplot com pontos."]},
    interpret:["Gráfico antes do teste."],
    mistakes:["Barra escondendo dados."],
    activity:"Faça 2 gráficos e compare.",
    dossier:["2 gráficos + justificativa curta."],
    saturday:"Sábado 14/03/2026: encontro online tira-dúvidas (foco: escolher gráfico correto e interpretar padrão/variabilidade).",
    quiz:[
      {q:"X–Y pede:", opts:["Dispersão","Pizza","Texto","Mapa"], ans:0, fb:["Correto.","Não.","Não.","Não."]},
      {q:"Boxplot é bom para:", opts:["Grupos","Mapas","Texto","Somente séries"], ans:0, fb:["Correto.","Não.","Não.","Não."]},
      {q:"Antes de teste:", opts:["Gráfico","Excluir outliers","Chutar","Somar tudo"], ans:0, fb:["Correto.","Não.","Não.","Não."]}
    ]
  };}

  function mkWeek4Short(){ return {
    goals:["Probabilidade e p-valor (ideia)."],
    definitions:[{term:"H0", def:"Modelo de sem efeito."},{term:"p-valor", def:"Compatibilidade com H0."}],
    howTo:{title:"Base", steps:["Descreva padrão no gráfico antes de qualquer teste."]},
    interpret:["Evitar ‘provar’. Use ‘sugerir’."],
    mistakes:["Confundir p com verdade."],
    activity:"Escreva uma conclusão cautelosa.",
    dossier:["Pergunta + gráfico + conclusão curta."],
    saturday:"Sábado 21/03/2026: encontro online tira-dúvidas (foco: linguagem científica e interpretação de incerteza).",
    quiz:[
      {q:"p-valor é:", opts:["Prova","Compatibilidade com H0","Causalidade","Variância"], ans:1, fb:["Não.","Correto.","Não.","Não."]},
      {q:"Primeiro passo é:", opts:["Gráfico","p<0,05","Excluir","Somar"], ans:0, fb:["Correto.","Não.","Não.","Não."]},
      {q:"Boa linguagem:", opts:["Provou","Sugeriu","Garantiu","Certeza"], ans:1, fb:["Não.","Correto.","Não.","Não."]}
    ]
  };}

  function mkWeek5Short(){ return {goals:["Distribuições básicas."],definitions:[{term:"Normal",def:"Simétrica."},{term:"Poisson",def:"Contagens."},{term:"Binomial",def:"Sucesso/fracasso."}],
    howTo:{title:"Base",steps:["Use histograma para ver formato."]},interpret:["Formato orienta análise."],mistakes:["Forçar normalidade."],
    activity:"Faça um histograma e descreva.",dossier:["Histograma + descrição."],
    saturday:"Sábado 28/03/2026: encontro online tira-dúvidas (foco: reconhecer distribuição pelo histograma).",
    quiz:[
      {q:"Poisson:",opts:["Contagem","Altura","Texto","Mapa"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Binomial:",opts:["Sucesso/fracasso","Temperatura","R²","Eixo"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Histograma mostra:",opts:["Distribuição","Causalidade","Mapa","Título"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek6Short(){ return {goals:["Premissas e outliers."],definitions:[{term:"Outlier",def:"Valor extremo."},{term:"Não paramétrico",def:"Menos sensível a premissas."}],
    howTo:{title:"Base",steps:["Olhe boxplot/histograma; justifique decisões."]},interpret:["Transparência."],mistakes:["Excluir sem justificar."],
    activity:"Analise 1 outlier.",dossier:["Gráfico + justificativa."],
    saturday:"Sábado 04/04/2026: encontro online tira-dúvidas (foco: outliers e premissas).",
    quiz:[
      {q:"Outlier remove quando:",opts:["Atrapalha","Há evidência de erro","Quero p","Nunca discuto"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Não paramétrico ajuda quando:",opts:["Assimetria forte","Sempre","Quero p","Texto"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Premissas se avaliam com:",opts:["Gráfico","Achismo","Título","Média"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek7Short(){ return {goals:["Teste t."],definitions:[{term:"Teste t",def:"2 grupos."}],
    howTo:{title:"Base",steps:["Boxplot + t no PAST."]},interpret:["Diferença + variabilidade."],mistakes:["Usar com 3+ grupos."],
    activity:"Compare 2 grupos.",dossier:["Boxplot + texto."],
    saturday:"Sábado 11/04/2026: encontro online tira-dúvidas (foco: teste t e interpretação).",
    quiz:[
      {q:"Teste t serve para:",opts:["2 grupos","3 grupos","Categorias x categorias","Causalidade"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Acompanhar com:",opts:["Boxplot","Só p","Só tabela","Nada"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"p<0,05 é:",opts:["Causa","Evidência contra H0","Prova","Sem ruído"],ans:1,fb:["Não.","Correto.","Não.","Não."]}
    ]};}

  function mkWeek8Short(){ return {goals:["ANOVA 1 via."],definitions:[{term:"ANOVA",def:"3+ grupos (global)."}],
    howTo:{title:"Base",steps:["ANOVA + Tukey (preferencial)."]},interpret:["Global + pares."],mistakes:["Vários t-tests."],
    activity:"Compare 3 grupos.",dossier:["Boxplot + conclusão."],
    saturday:"Sábado 18/04/2026: encontro online tira-dúvidas (foco: ANOVA e pós-testes).",
    quiz:[
      {q:"ANOVA responde:",opts:["Qual par sem pós","Diferença global","Causalidade","Normalidade"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Pós-teste:",opts:["Outlier","Quais pares diferem","Causa","Unidade"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Erro comum:",opts:["Vários t-tests","Boxplot","Limitação","Tabela"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek9Short(){ return {goals:["ANOVA 2 vias e interação."],definitions:[{term:"Interação",def:"Efeito depende do outro fator."}],
    howTo:{title:"Base",steps:["Veja linhas não paralelas em gráfico."]},interpret:["Efeito muda com fator."],mistakes:["Ignorar interação."],
    activity:"Faça gráfico de interação.",dossier:["Gráfico + texto."],
    saturday:"Sábado 25/04/2026: encontro online tira-dúvidas (foco: interação e leitura do gráfico).",
    quiz:[
      {q:"Interação:",opts:["Efeito constante","Efeito depende","Outlier","Normal"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Sinal visual:",opts:["Linhas paralelas","Não paralelas","Barras","Texto"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Risco:",opts:["Ignorar interação","Fazer gráfico","Relatar limites","Ter réplica"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek10Short(){ return {goals:["Qui-quadrado."],definitions:[{term:"Contingência",def:"Tabela de contagens."}],
    howTo:{title:"Base",steps:["Montar 2x2 e rodar qui²."]},interpret:["Associação em categorias."],mistakes:["Células muito baixas."],
    activity:"Conte categorias por dias.",dossier:["Tabela + barras."],
    saturday:"Sábado 02/05/2026: encontro online tira-dúvidas (foco: tabelas de contingência).",
    quiz:[
      {q:"Qui² é para:",opts:["Categóricas","2 grupos numéricos","Regressão","Normal"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Entrada do qui²:",opts:["Médias","Contagens","R²","Inclinação"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Mostrar:",opts:["Só p","Barras contagem/proporção","Só texto","Nada"],ans:1,fb:["Não.","Correto.","Não.","Não."]}
    ]};}

  function mkWeek11Short(){ return {goals:["Correlação."],definitions:[{term:"Pearson",def:"Linear."},{term:"Spearman",def:"Ranking."}],
    howTo:{title:"Base",steps:["Scatter obrigatório." ]},interpret:["Não é causalidade."],mistakes:["Dizer causa."],
    activity:"Compare Pearson vs Spearman.",dossier:["Scatter + cautela."],
    saturday:"Sábado 09/05/2026: encontro online tira-dúvidas (foco: correlação e interpretação).",
    quiz:[
      {q:"Correlação prova causa?",opts:["Sim","Não","Só p<0,05","Só sem outlier"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Pearson:",opts:["Linear","Texto","Mapa","Categoria pura"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Scatter serve:",opts:["Relação X–Y","Contingência","Boxplot","Causa"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek12Short(){ return {goals:["Regressão linear."],definitions:[{term:"Inclinação",def:"Mudança de Y por X."},{term:"Resíduo",def:"Erro observado-previsto."}],
    howTo:{title:"Base",steps:["Scatter + ajuste; interpretar inclinação." ]},interpret:["Escreva em unidades reais."],mistakes:["Extrapolar."],
    activity:"Rode regressão simples.",dossier:["Scatter + interpretação."],
    saturday:"Sábado 16/05/2026: encontro online tira-dúvidas (foco: regressão e resíduos).",
    quiz:[
      {q:"Inclinação:",opts:["Mudança de Y por X","Cor","Causa","Outlier"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"R² mede:",opts:["Causa","Parte explicada no modelo","Normalidade","Categoria"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Erro:",opts:["Extrapolar","Interpretar","Plotar","Limitar"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek13Short(){ return {goals:["GLM."],definitions:[{term:"Poisson",def:"Contagem."},{term:"Binomial",def:"Proporção."}],
    howTo:{title:"Base",steps:["Justifique GLM pelo tipo de Y." ]},interpret:["Taxa/chance."],mistakes:["Forçar linear em contagem."],
    activity:"Escolha Y contagem/proporção.",dossier:["Gráfico + justificativa."],
    saturday:"Sábado 23/05/2026: encontro online tira-dúvidas (foco: quando usar GLM).",
    quiz:[
      {q:"GLM útil quando:",opts:["Contagem/proporção","Texto","Sempre","Para p"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Poisson:",opts:["Contagem","Altura","Categoria","Mapa"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Binomial:",opts:["Sucesso/fracasso","Temperatura","R²","Intercepto"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek14Short(){ return {goals:["ANCOVA, confundidores, viés."],definitions:[{term:"Confundidor",def:"Afeta X e Y."},{term:"ANCOVA",def:"Ajusta por covariável."}],
    howTo:{title:"Base",steps:["Identifique 1 confundidor e como controlar." ]},interpret:["Efeito ajustado."],mistakes:["Enfeitar modelo."],
    activity:"Reescreva pergunta com controle.",dossier:["Confundidor + estratégia."],
    saturday:"Sábado 30/05/2026: encontro online tira-dúvidas (foco: confundidores, viés e controle).",
    quiz:[
      {q:"Confundidor:",opts:["Afeta X e Y","Outlier","p","Eixo"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"ANCOVA:",opts:["Compara grupos ajustando covariável","Soma médias","Remove outliers","Prova causa"],ans:0,fb:["Correto.","Não.","Não.","Não."]},
      {q:"Teste cego reduz:",opts:["Viés de expectativa","Réplica","Dados","DP"],ans:0,fb:["Correto.","Não.","Não.","Não."]}
    ]};}

  function mkWeek15Short(){ return {goals:["Projeto final."],definitions:[{term:"Discussão",def:"Interpretação com limites."}],
    howTo:{title:"Base",steps:["Pergunta → dados → gráficos → análise → limites." ]},interpret:["Coerência."],mistakes:["Conclusão sem limite."],
    activity:"Apresentação final.",dossier:["Entrega final (CSV+figuras+apresentação)."],
    saturday:"Sábado 06/06/2026: encontro online tira-dúvidas (foco: revisão final e apresentação).",
    quiz:[
      {q:"Projeto profundo é:",opts:["Complicado","Coerente e honesto","Só fórmulas","Sem gráfico"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Obrigatório:",opts:["Só p","Dados+gráficos+interpretação","Só texto","Só título"],ans:1,fb:["Não.","Correto.","Não.","Não."]},
      {q:"Limitação serve:",opts:["Enfraquecer","Dar honestidade e orientar próximos passos","Excluir","Provar causa"],ans:1,fb:["Não.","Correto.","Não.","Não."]}
    ]};}

  // =======================
  // 5) UI helpers
  // =======================
  function renderList(){
    const list = document.getElementById("lessonList");
    list.innerHTML = "";
    LESSONS.forEach(ls=>{
      const isDone = !!state.done[ls.id];
      const btn = document.createElement("button");
      btn.className="lessonBtn";
      btn.innerHTML = `
        <div class="topLine">
          <span>Semana ${ls.id} • ${ls.title}</span>
          <span class="tag ${isDone?"ok":""}">${isDone?"Concluída":"Pendente"}</span>
        </div>
        <div class="dates">${ls.dates}</div>
      `;
      btn.addEventListener("click", ()=>openLesson(ls.id));
      list.appendChild(btn);
    });
  }

  function renderLinks(list){
    const ok = (list||[]).filter(x=>x && x.url);
    if(!ok.length) return `<p style="color:#475569;font-size:12px">Sem links cadastrados.</p>`;
    return `<div class="links">${ok.map(x=>`<p>• <a href="${x.url}" target="_blank" rel="noopener noreferrer">${x.label||x.url}</a></p>`).join("")}</div>`;
  }

  function buildLinkEditor(id){
    const cur = getLinksFor(id).map(x=>({label:x.label||"", url:x.url||""}));
    const holder = document.createElement("div");
    holder.className="box";
    holder.innerHTML=`
      <strong>Editar links (Khan/YouTube)</strong>
      <div style="color:#475569;margin-top:6px;font-size:12px">
        Cole links em português. Sem artigos aqui.
      </div>
      <div id="items"></div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        <button class="accent" id="add">+ Adicionar link</button>
        <button class="primary" id="save">Salvar links</button>
        <button id="reset">Voltar ao padrão (Khan)</button>
      </div>
    `;
    const itemsEl = holder.querySelector("#items");

    function rerender(){
      itemsEl.innerHTML="";
      cur.forEach((it,idx)=>{
        const item=document.createElement("div");
        item.className="linkItem";
        item.innerHTML=`
          <div class="row">
            <div>
              <div style="font-size:12px;color:#475569"><strong>Título</strong></div>
              <input type="text" value="${it.label.replaceAll('"','&quot;')}" data-i="${idx}" data-k="label" placeholder="Ex.: YouTube – Tipos de variáveis (PT)"/>
            </div>
            <div>
              <div style="font-size:12px;color:#475569"><strong>URL</strong></div>
              <input type="url" value="${it.url.replaceAll('"','&quot;')}" data-i="${idx}" data-k="url" placeholder="https://..."/>
            </div>
          </div>
          <div style="margin-top:10px"><button class="warn" data-del="${idx}">Remover</button></div>
        `;
        itemsEl.appendChild(item);
      });

      itemsEl.querySelectorAll("input").forEach(inp=>{
        inp.addEventListener("input", ()=>{
          const i=Number(inp.dataset.i), k=inp.dataset.k;
          cur[i][k]=inp.value;
        });
      });
      itemsEl.querySelectorAll("button[data-del]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const i=Number(btn.dataset.del);
          cur.splice(i,1);
          rerender();
        });
      });
    }
    rerender();

    holder.querySelector("#add").addEventListener("click", ()=>{cur.push({label:"",url:""});rerender();});
    holder.querySelector("#save").addEventListener("click", ()=>{
      state.links[id]=cur.filter(x=>x.label||x.url);
      saveState();
      alert("Links salvos.");
      openLesson(id);
    });
    holder.querySelector("#reset").addEventListener("click", ()=>{
      delete state.links[id];
      saveState();
      alert("Voltou ao padrão.");
      openLesson(id);
    });

    return holder;
  }

  function buildQuiz(week){
    const qs = week.quiz || [];
    const box = document.createElement("div");
    box.className="quiz";
    box.innerHTML=`
      <div><strong>Quiz curto</strong></div>
      <div style="color:#475569;margin-top:6px;font-size:12px">Objetivo: checar entendimento do conteúdo desta semana.</div>
      <div id="qs"></div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        <button class="primary" id="grade">Corrigir</button>
      </div>
      <div class="result" id="res"></div>
    `;
    const qsEl = box.querySelector("#qs");
    qs.forEach((q,qi)=>{
      const w = document.createElement("div");
      w.className="q";
      w.innerHTML=`
        <div class="qtitle">${qi+1}) ${q.q}</div>
        <div class="opts">${q.opts.map((o,oi)=>`<label><input type="radio" name="q_${week._id}_${qi}" value="${oi}"/> ${o}</label>`).join("")}</div>
      `;
      qsEl.appendChild(w);
    });

    box.querySelector("#grade").addEventListener("click", ()=>{
      let score=0;
      const lines=[];
      qs.forEach((q,qi)=>{
        const chosen = box.querySelector(`input[name="q_${week._id}_${qi}"]:checked`);
        const a = chosen ? Number(chosen.value) : null;
        const ok = (a===q.ans);
        if(ok) score++;
        const fb = (a===null) ? "Sem resposta." : q.fb[a];
        lines.push(`${qi+1}) ${ok?"Certo":"Errado"} – ${fb}`);
      });
      const res=box.querySelector("#res");
      res.style.display="block";
      res.textContent=`Pontuação: ${score}/${qs.length}\n\n`+lines.join("\n");
    });

    return box;
  }

  function block(title, chip, html, open=false){
    const d=document.createElement("details");
    d.open=open;
    d.innerHTML=`<summary>${title} <span class="chip">${chip}</span></summary><div class="sec">${html}</div>`;
    return d;
  }

  // =======================
  // 6) OPEN WEEK
  // =======================
  function openLesson(id){
    state.currentId=id; saveState();
    const ls = LESSONS.find(x=>x.id===id);
    const week = COURSE[id];
    if(!ls || !week) return;

    document.getElementById("title").textContent = `Semana ${ls.id} – ${ls.title}`;
    document.getElementById("meta").textContent = `Período: ${ls.dates}`;

    const panels=document.getElementById("panels");
    panels.innerHTML="";

    panels.appendChild(block("1) O que você vai aprender", "objetivos",
      `<ul>${(week.goals||[]).map(x=>`<li>${x}</li>`).join("")}</ul>
       <div class="box ok"><strong>Orientação:</strong> Salve suas notas no navegador ou no celular.</div>`, true
    ));

    if(week.mindset){
      panels.appendChild(block("2) Mentalidade científica (como um cientista pensa)", "guia",
        `<div class="callout">${week.mindset.map(p=>`<p>${p}</p>`).join("")}</div>`, false
      ));
    }

    if(week.story){
      panels.appendChild(block("3) Um mini-caso para enxergar o problema", "exemplo",
        week.story.map(p=>`<p>${p}</p>`).join(""), false
      ));
    }

    panels.appendChild(block("4) Definições (do zero)", "conceitos",
      `<ul>${(week.definitions||[]).map(d=>`<li><strong>${d.term}:</strong> ${d.def}</li>`).join("")}</ul>`, true
    ));

    if(week.howTo){
      const h = week.howTo;
      panels.appendChild(block("5) Como fazer (passo a passo)", "mão na massa",
        `<p><strong>${h.title||""}</strong></p>
         ${h.steps ? `<ol>${h.steps.map(x=>`<li>${x}</li>`).join("")}</ol>` : ""}
         ${h.dataIdeas ? `<div class="box purple"><strong>Observação:</strong><ul>${h.dataIdeas.map(x=>`<li>${x}</li>`).join("")}</ul></div>` : ""}`,
        false
      ));
    }

    panels.appendChild(block("6) Como interpretar (o que escrever no dossiê)", "interpretação",
      (week.interpret||[]).map(p=>`<p>${p}</p>`).join(""), false
    ));

    panels.appendChild(block("7) Erros comuns desta semana (evite)", "atenção",
      `<div class="box warn"><ul>${(week.mistakes||[]).map(x=>`<li>${x}</li>`).join("")}</ul></div>`, false
    ));

    panels.appendChild(block("8) Atividade da semana (cabe em 4h)", "atividade",
      `<div class="box ok"><strong>Tarefa:</strong> ${week.activity||"—"}</div>`, false
    ));

    let dossierHtml = `<ol>${(week.dossier||[]).map(x=>`<li>${x}</li>`).join("")}</ol>`;
    if(week.dossierModelText){
      dossierHtml += `<div class="box"><strong>Texto-modelo (exemplo do professor):</strong><p style="margin:8px 0 0">${week.dossierModelText}</p></div>`;
    }
    dossierHtml += `<div class="box"><strong>Correção rápida:</strong> eu olho se a pergunta está clara, se a tabela está correta, se há réplicas e se o gráfico conversa com a pergunta.</div>`;
    panels.appendChild(block("9) Dossiê (1 lauda) – modelo desta semana", "entrega", dossierHtml, false));

    if(week.saturday){
      panels.appendChild(block("10) Sábado (orientação)", "sábado",
        `<div class="box warn"><p>${week.saturday}</p></div>`, false
      ));
    }

    const links = getLinksFor(id);
    panels.appendChild(block("11) Links (Khan/YouTube)", "editável",
      `<p><strong>Links desta semana:</strong></p>${renderLinks(links)}`, false
    ));

    const ed=document.createElement("details");
    ed.open=false;
    ed.innerHTML=`<summary>Editar links da semana <span class="chip">somente links</span></summary><div class="sec" id="ed"></div>`;
    ed.querySelector("#ed").appendChild(buildLinkEditor(id));
    panels.appendChild(ed);

    const q=document.createElement("details");
    q.open=false;
    week._id=id;
    q.innerHTML=`<summary>Quiz da semana <span class="chip">3 questões</span></summary><div class="sec" id="qm"></div>`;
    q.querySelector("#qm").appendChild(buildQuiz(week));
    panels.appendChild(q);

    updateButtons();
  }

  function updateButtons(){
    const id=state.currentId;
    const done=!!state.done[id];
    document.getElementById("btnDone").disabled=!id||done;
    document.getElementById("btnUndone").disabled=!id||!done;
  }

  // =======================
  // 7) Botões
  // =======================
  document.getElementById("btnDone").addEventListener("click", ()=>{
    if(!state.currentId) return;
    state.done[state.currentId]=true; saveState(); renderList(); updateButtons();
  });
  document.getElementById("btnUndone").addEventListener("click", ()=>{
    if(!state.currentId) return;
    delete state.done[state.currentId]; saveState(); renderList(); updateButtons();
  });
  document.getElementById("btnExport").addEventListener("click", ()=>{
    const payload={exportedAt:new Date().toISOString(), done:state.done, links:state.links};
    const blob=new Blob([JSON.stringify(payload,null,2)],{type:"application/json"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob); a.download="progresso-curso.json";
    document.body.appendChild(a); a.click(); a.remove();
    setTimeout(()=>URL.revokeObjectURL(a.href),1500);
  });
  document.getElementById("btnReset").addEventListener("click", ()=>{
    if(!confirm("Resetar tudo neste navegador?")) return;
    localStorage.removeItem(KEY);
    state={currentId:null, done:{}, links:{}};
    renderList();
    document.getElementById("title").textContent="Selecione uma semana";
    document.getElementById("meta").textContent="—";
    document.getElementById("panels").innerHTML="";
    updateButtons();
  });

  // =======================
  // 8) INIT
  // =======================
  loadState();
  renderList();
  openLesson(state.currentId || 1);
</script>
</body>
</html>
